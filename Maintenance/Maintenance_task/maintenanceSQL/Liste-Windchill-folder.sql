SELECT s.name as Site, fv.name as Vault, ff.seqnumber, ff.name as Folder, ff.ida2a2 as FolderID, decode(fv.formastereditems, 1, 'Cache') as Cache, ff.enabled, ff.readonly, ff.threshold, fh.hostname, fm.status as MountStatus, fm.path, files.Files, round(files.FileSizeBytes / POWER(1024,2),2) as FileSizeMB, null as CachedFiles, null as CachedFileSizeMB, LastCreateStamp  FROM  ((((site s INNER JOIN fvvault fv ON s.ida2a2=fv.ida3a5) INNER JOIN fvfolder ff ON fv.ida2a2=ff.ida3a5) INNER JOIN fvmount fm ON ff.ida2a2=fm.ida3a5) INNER JOIN fvhost fh ON fh.ida2a2=fm.ida3b5)  LEFT OUTER JOIN  (SELECT DISTINCT fi.ida3a4 as FolderID, count(DISTINCT(fi.uniquesequencenumber)) as Files, sum(ad.filesize) as FileSizeBytes, max(fi.createstampa2) as LastCreateStamp  FROM (fvitem fi INNER JOIN applicationdata ad ON fi.streamid=ad.streamid)  GROUP BY fi.ida3a4) files  ON ff.ida2a2=files.FolderID  UNION ALL  SELECT s.name as Site, rv.name as Vault, rf.seqnumber, rf.name as Folder, rf.ida2a2 as FolderID, decode(rv.formastereditems, 1, 'Cache') as Cache, rf.enabled, rf.readonly, rf.threshold, fh.hostname, fm.status as MountStatus, fm.path, replicated.Files, round(replicated.FileSizeBytes / POWER(1024,2),2) as FileSizeMB, cached.Files as CachedFiles, round(cached.FileSizeBytes / POWER(1024,2),2) as CachedFileSizeMB, greatest(COALESCE(replicated.LastCreateStamp, cached.LastCreateStamp), COALESCE(cached.LastCreateStamp, replicated.LastCreateStamp)) as LastCreateStamp  FROM  ((((site s INNER JOIN replicavault rv ON s.ida2a2=rv.ida3a5) INNER JOIN replicafolder rf ON rv.ida2a2=rf.ida3a5) INNER JOIN fvmount fm ON rf.ida2a2=fm.ida3a5) INNER JOIN fvhost fh ON fh.ida2a2=fm.ida3b5)  LEFT OUTER JOIN  (SELECT DISTINCT ri.ida3a4 as FolderID, count(DISTINCT(ri.uniquesequencenumber)) as Files, sum(ad.filesize) as FileSizeBytes, max(ri.createstampa2) as LastCreateStamp  FROM (replicateditem ri INNER JOIN applicationdata ad ON ri.streamid=ad.streamid)  GROUP BY ri.ida3a4) replicated  ON rf.ida2a2=replicated.FolderID  LEFT OUTER JOIN  (SELECT DISTINCT ri.ida3a4 as FolderID, count(DISTINCT(ri.uniquesequencenumber)) as Files, sum(ad.filesize) as FileSizeBytes, max(ri.createstampa2) as LastCreateStamp  FROM (masteredonreplicaitem ri INNER JOIN applicationdata ad ON ri.streamid=ad.streamid)  GROUP BY RI.IDA3A4) CACHED  ON rf.ida2a2=cached.FolderID